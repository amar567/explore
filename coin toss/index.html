<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coin toss exp</title>

    <script src="https://cdn.plot.ly/plotly-latest.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.js" integrity="sha384-U8Vrjwb8fuHMt6ewaCy8uqeUXv4oitYACKdB0VziCerzt011iQ/0TqlSlv8MReCm" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/contrib/auto-render.min.js" integrity="sha384-aGfk5kvhIq5x1x5YdvCp4upKZYnA8ckafviDpmWEKp4afOZEqOli7gqSnh8I6enH" crossorigin="anonymous"></script>


</head>
<body>
    <div class="container" style="display: flex;flex-direction: row;justify-content: space-around;">
        <div class="leftSide" style="width: 50%;">
            <div id='coinExp'></div>
            <div style="display: flex;flex-direction: row;width: 100%;justify-content: space-between; ">
                <h2>No. of iterations : <span id="count"></span></h2>
                <div style="display:flex;flex-direction:row;justify-content:center;align-items:center;">
                    <h2>play/pause</h2> &nbsp;&nbsp;
                    <button id="playPauseBtn" class="is-playing" style="width: 50px;height: 50px;border-radius: 100px;border: 0;background-color: rgb(209, 209, 209);display: flex;justify-content: center;align-items: center;">▌▌</button>
                </div>
            </div>
        </div>
        <div class="rightSide">

            <h1>Coin toss experiment</h1>

            <p>
                Here we plot <i style="color: rgb(70, 70, 70);">Frequency</i> vs <i style="color: rgb(70, 70, 70);">No. of heads</i> while tossing a coin n time simultaneously in this simulation.
                <br>
                Where probability of getting k heads is given by:
                <br>
                $${\Pr(k;n,p)= {\binom {n}{k}}p^{k}(1-p)^{n-k}}$$
                <br>
                here:
                <p>
                    n : is the number of tosses per trial.
                    <br>
                    p : is the probability of getting a head in any individual toss.
                    <br>
                    k : is the number of heads in a trial.
                </p>

                <br>
                <h2>Choose n</h2>
                <p>
                    Choose n and press plot to see the graph.
                </p>
                <form action="">
                    <input name="coinTossIterations" type="number" id="iterations" placeholder="No of tosses per iteration"></input>
                    <button type="submit">Plot</button>
                </form>
            </p>
        </div>
    </div>

    <script>
        var url_string = window.location.href
        var url = new URL(url_string);
    </script>
    
    <script>

        let n_iterations = 0 ;
        let tosses_per_iteration = url.searchParams.get("coinTossIterations") || 21;

        document.getElementById("iterations").value = tosses_per_iteration;

        var data ={
            x: [],
            y: [],
            type: 'bar'
        };

        var layout = {
            title: 'Coin toss experiment',
            xaxis: {
                title: 'no. of heads (k)'
            },
            yaxis: {
                title: 'frequency (F)'
            },
            width: 800,
            height: 600
        };

        for (let i = 0; i <= tosses_per_iteration; i++) {
            data.x.push("​" + i);
            data.y.push(0);
        }

        Plotly.plot('coinExp', [data], layout);

        let tossCoin = (tosses_per_iteration) => {
            count = 0
            for (let i = 0; i < tosses_per_iteration; i++) {
                if (Math.floor(Math.random() * 2) == 1) {
                    count++
                }
            }
            return count
        }

        let updateData = (tosses_per_iteration) => {
            let result = tossCoin(tosses_per_iteration)
            data.y[result]++
            n_iterations++
            document.getElementById('count').innerHTML = n_iterations
        }

        let iterate = setInterval(()=>{Plotly.restyle('coinExp', 'y', [data.y]);}, 300)

        let plotIteration = setInterval(()=>{updateData(tosses_per_iteration)}, 0);

        document.getElementById("playPauseBtn").addEventListener("click", function(){

            if(this.className == 'is-playing'){
                this.className = "";
                this.innerHTML = "▶"
                clearInterval(iterate)
                clearInterval(plotIteration)
            }else{
                this.className = "is-playing";
                this.innerHTML = "▌▌";
                iterate = setInterval(()=>{Plotly.restyle('coinExp', 'y', [data.y]);}, 300)
                plotIteration = setInterval(()=>{updateData(tosses_per_iteration)}, 0);
            }

        });
    </script>

    <script>
        renderMathInElement(document.body, {
            delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: true},
            {left: "\\(", right: "\\)", display: false},
            {left: "\\[", right: "\\]", display: true},
            {left: "\\begin{equation}", right: "\\end{equation}", display: true}
            ]
        });
    </script>

</body>
</html>